import{f as O,r as i,j as t}from"./index-WpJvKgqq.js";import{u as q}from"./useProducts-Dx4zUwWl.js";import{u as E}from"./useBrands-CDPoW7rD.js";const D=n=>n.toLocaleString("en-IN",{maximumFractionDigits:0}),S=(n,l)=>{if(!n||!l||n<=l)return null;const u=Math.round((n-l)/n*100);return u>0?u:null},T=()=>{const{category:n}=O(),{data:l,isLoading:u}=q(),{data:p,isLoading:P}=E(),[h,f]=i.useState("All"),[g,v]=i.useState("All"),[d,y]=i.useState("All"),[x,A]=i.useState("All"),[_,L]=i.useState("All"),[a,B]=i.useState("Relevance"),b=i.useMemo(()=>Array.isArray(l)?l:[],[l]),m=i.useMemo(()=>n?b.filter(e=>e?.category?.slug===n):b,[b,n]),w=i.useMemo(()=>{const e=new Map;return m.forEach(s=>{s?.category?.slug&&e.set(s.category.slug,{name:s.category.name,slug:s.category.slug})}),[{name:"All",slug:"All"},...Array.from(e.values())]},[m]),M=i.useMemo(()=>{const e=Array.isArray(p)?p.filter(r=>r.is_active):[];return e.length?["All",...e.map(r=>r.name)]:["All",...Array.from(new Set(m.map(r=>r.brand?.name).filter(Boolean)))]},[p,m]),N=i.useMemo(()=>{let e=[...m];return h!=="All"&&(e=e.filter(s=>s.category?.slug===h)),g!=="All"&&(e=e.filter(s=>s.brand?.name===g)),d!=="All"&&(e=e.filter(s=>{const r=Number(s.price);return Number.isNaN(r)?!1:d==="Under 40k"?r<4e4:d==="40k - 70k"?r>=4e4&&r<=7e4:d==="70k+"?r>7e4:!0})),x!=="All"&&(e=e.filter(s=>{const r=Number(s.price),o=s.old_price?Number(s.old_price):0,c=S(o,r)??0;return x==="10%+"?c>=10:x==="20%+"?c>=20:!0})),e.sort((s,r)=>{const o=Number(s.price)||0,c=Number(r.price)||0;return a==="Relevance"?0:a==="Price: Low to High"?o-c:a==="Price: High to Low"?c-o:a==="Rating"?0:a==="Newest"?new Date(r.created_at).getTime()-new Date(s.created_at).getTime():0}),e},[m,h,g,_,d,x,a]),R=N.length,k=()=>{f("All"),v("All"),y("All"),A("All"),L("All"),B("Relevance")};i.useEffect(()=>{f("All")},[n]);const C=i.useMemo(()=>n?w.find(s=>s.slug===n)?.name||n:"Products",[n,w]),j=u||P;return t.jsx("div",{className:"min-h-screen bg-[#0B0B0D] text-white",children:t.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-6",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-white/60",children:[t.jsx("span",{className:"hover:text-white transition cursor-pointer",children:"Home"}),t.jsx("span",{className:"text-white/30",children:"›"}),t.jsx("span",{className:"hover:text-white transition cursor-pointer",children:"Categories"}),t.jsx("span",{className:"text-white/30",children:"›"}),t.jsx("span",{className:"text-white font-semibold",children:C})]}),t.jsx("div",{className:"mt-2 flex items-end justify-between gap-4",children:t.jsx("div",{children:t.jsxs("h1",{className:"text-2xl md:text-3xl font-medium tracking-tight capitalize",children:[C," ",t.jsxs("span",{className:"text-white/60 text-sm",children:["(",R,")"]})]})})}),t.jsxs("div",{className:"mt-5 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("select",{value:h,onChange:e=>f(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:w.map(e=>t.jsxs("option",{value:e.slug,className:"bg-[#0B0B0D]",children:["Categories: ",e.name]},e.slug))}),t.jsx("select",{value:g,onChange:e=>v(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:M.map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Brand: ",e]},e))}),t.jsx("select",{value:d,onChange:e=>y(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["All","Under 40k","40k - 70k","70k+"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Price: ",e]},e))}),t.jsx("select",{value:x,onChange:e=>A(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["All","10%+","20%+"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Discount: ",e]},e))}),t.jsx("button",{onClick:k,className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white hover:bg-white/10 transition",children:"Clear Filters"})]}),t.jsx("div",{className:"flex items-center justify-between gap-3 lg:justify-end",children:t.jsx("select",{value:a,onChange:e=>B(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["Relevance","Price: Low to High","Price: High to Low","Rating","Newest"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Sort By ",e]},e))})})]}),j&&t.jsx("div",{className:"mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:t.jsx("p",{className:"text-sm text-white/70",children:"Loading products..."})}),!j&&t.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:N.map(e=>{const s=Number(e.price)||0,r=e.old_price?Number(e.old_price):void 0,o=S(r,s),c=e.stock<=0;return t.jsxs("div",{className:"group rounded-xl border border-white/10 bg-white/5 p-4 hover:bg-white/10 transition",children:[t.jsx("div",{className:"relative rounded-lg bg-white/10 p-5 h-[240px] flex items-center justify-center overflow-hidden",children:t.jsx("img",{src:e.image||"https://via.placeholder.com/400x400?text=No+Image",alt:e.name,className:"h-full w-full object-contain group-hover:scale-[1.03] transition duration-300"})}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-sm font-medium leading-snug text-white line-clamp-2",children:e.name}),t.jsxs("div",{className:"mt-2 text-xs text-white/50",children:[t.jsx("span",{className:"font-semibold text-white/70",children:e.brand?.name})," ","•"," ",t.jsx("span",{className:"text-white/60",children:e.category?.name})]}),t.jsx("div",{children:e.description&&t.jsx("p",{className:"mt-2 text-xs text-white/50 line-clamp-2",children:e.description})}),t.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3",children:[t.jsxs("span",{className:"text-2xl font-medium tracking-tight",children:["₹",D(s)]}),!!r&&t.jsxs("span",{className:"text-sm text-white/40 line-through",children:["₹",D(r)]}),o!==null&&t.jsxs("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-bold text-white",children:[o,"% Off"]})]}),t.jsx("div",{children:e.min_order_quantity&&t.jsxs("span",{className:"text-xs text-white/50",children:["Min Order Quantity: ",e.min_order_quantity]})}),t.jsx("div",{className:"mt-3 text-xs",children:c?t.jsx("span",{className:"text-red-400 font-semibold",children:"Out of stock"}):t.jsxs("span",{className:"text-emerald-300 font-semibold",children:["In stock (",e.stock,")"]})}),t.jsx("div",{className:"mt-5",children:t.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-200 px-4 py-2 text-xs font-extrabold text-black",children:"Order Now"})})]}),t.jsx("div",{className:"mt-6 h-px w-full bg-white/10"})]},e.id)})}),!j&&N.length===0&&t.jsxs("div",{className:"mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:[t.jsx("p",{className:"text-lg font-extrabold",children:"No products found"}),t.jsx("p",{className:"mt-2 text-sm text-white/60",children:"Try adjusting filters or clear all filters to see items."}),t.jsx("button",{onClick:k,className:"mt-5 rounded-xl bg-[#E02C2C] px-5 py-3 text-sm font-bold hover:bg-[#B91C1C] transition",children:"Clear Filters"})]})]})})};export{T as default};
