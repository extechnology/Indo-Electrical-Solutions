import{h as U,r as n,j as t}from"./index-BUQDLFwz.js";import{u as $}from"./useProducts-DMgwaGb0.js";import{u as F}from"./useBrands-Bc6EqZsK.js";const R=l=>l.toLocaleString("en-IN",{maximumFractionDigits:0}),L=(l,a)=>{if(!l||!a||l<=a)return null;const x=Math.round((l-a)/l*100);return x>0?x:null},V=()=>{const{category:l}=U(),{data:a,isLoading:x}=$(),{data:p,isLoading:_}=F(),[f,A]=n.useState(null),b=n.useRef(null),[h,w]=n.useState("All"),[g,B]=n.useState("All"),[c,C]=n.useState("All"),[u,k]=n.useState("All"),[M,E]=n.useState("All"),[o,D]=n.useState("Relevance"),N=n.useMemo(()=>Array.isArray(a)?a:[],[a]),d=n.useMemo(()=>l?N.filter(e=>e?.category?.slug===l):N,[N,l]),v=n.useMemo(()=>{const e=new Map;return d.forEach(s=>{s?.category?.slug&&e.set(s.category.slug,{name:s.category.name,slug:s.category.slug})}),[{name:"All",slug:"All"},...Array.from(e.values())]},[d]),I=n.useMemo(()=>{const e=Array.isArray(p)?p.filter(r=>r.is_active):[];return e.length?["All",...e.map(r=>r.name)]:["All",...Array.from(new Set(d.map(r=>r.brand?.name).filter(Boolean)))]},[p,d]),j=n.useMemo(()=>{let e=[...d];return h!=="All"&&(e=e.filter(s=>s.category?.slug===h)),g!=="All"&&(e=e.filter(s=>s.brand?.name===g)),c!=="All"&&(e=e.filter(s=>{const r=Number(s.price);return Number.isNaN(r)?!1:c==="Under 40k"?r<4e4:c==="40k - 70k"?r>=4e4&&r<=7e4:c==="70k+"?r>7e4:!0})),u!=="All"&&(e=e.filter(s=>{const r=Number(s.price),i=s.old_price?Number(s.old_price):0,m=L(i,r)??0;return u==="10%+"?m>=10:u==="20%+"?m>=20:!0})),e.sort((s,r)=>{const i=Number(s.price)||0,m=Number(r.price)||0;return o==="Relevance"?0:o==="Price: Low to High"?i-m:o==="Price: High to Low"?m-i:o==="Rating"?0:o==="Newest"?new Date(r.created_at).getTime()-new Date(s.created_at).getTime():0}),e},[d,h,g,M,c,u,o]),H=j.length,P=()=>{w("All"),B("All"),C("All"),k("All"),E("All"),D("Relevance")};n.useEffect(()=>{const e=s=>{b.current&&!b.current.contains(s.target)&&A(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),n.useEffect(()=>{w("All")},[l]);const S=n.useMemo(()=>l?v.find(s=>s.slug===l)?.name||l:"Products",[l,v]),O=e=>{if(!e.includes("#"))return t.jsx("p",{children:e});const s=e.split("#").map(r=>r.trim()).filter(Boolean);return t.jsx("ul",{className:"list-disc pl-4 space-y-1",children:s.map((r,i)=>t.jsx("li",{children:r},i))})},y=x||_,q="917664939393",T=e=>{const s=`Hi, I am interested in this product:

${e.name}

Product ID: ${e.id}`;return`https://wa.me/${q}?text=${encodeURIComponent(s)}`};return t.jsx("div",{className:"min-h-screen bg-[#0B0B0D] text-white",children:t.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-6",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-white/60",children:[t.jsx("span",{className:"hover:text-white transition cursor-pointer",children:"Home"}),t.jsx("span",{className:"text-white/30",children:"›"}),t.jsx("span",{className:"hover:text-white transition cursor-pointer",children:"Categories"}),t.jsx("span",{className:"text-white/30",children:"›"}),t.jsx("span",{className:"text-white font-semibold",children:S})]}),t.jsx("div",{className:"mt-2 flex items-end justify-between gap-4",children:t.jsx("div",{children:t.jsxs("h1",{className:"text-2xl md:text-3xl font-medium tracking-tight capitalize",children:[S," ",t.jsxs("span",{className:"text-white/60 text-sm",children:["(",H,")"]})]})})}),t.jsxs("div",{className:"mt-5 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("select",{value:h,onChange:e=>w(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:v.map(e=>t.jsxs("option",{value:e.slug,className:"bg-[#0B0B0D]",children:["Categories: ",e.name]},e.slug))}),t.jsx("select",{value:g,onChange:e=>B(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:I.map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Brand: ",e]},e))}),t.jsx("select",{value:c,onChange:e=>C(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["All","Under 40k","40k - 70k","70k+"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Price: ",e]},e))}),t.jsx("select",{value:u,onChange:e=>k(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["All","10%+","20%+"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Discount: ",e]},e))}),t.jsx("button",{onClick:P,className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white hover:bg-white/10 transition",children:"Clear Filters"})]}),t.jsx("div",{className:"flex items-center justify-between gap-3 lg:justify-end",children:t.jsx("select",{value:o,onChange:e=>D(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["Relevance","Price: Low to High","Price: High to Low","Rating","Newest"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Sort By ",e]},e))})})]}),y&&t.jsx("div",{className:"mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:t.jsx("p",{className:"text-sm text-white/70",children:"Loading products..."})}),!y&&t.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-4",children:j.map(e=>{const s=Number(e.price)||0,r=e.old_price?Number(e.old_price):void 0,i=L(r,s);return t.jsxs("div",{className:"group relative flex h-full flex-col rounded-xl border border-white/10 bg-white/5 p-4 transition hover:bg-white/10",children:[t.jsx("div",{className:"relative h-[240px] overflow-hidden rounded-lg bg-white p-5",children:t.jsx("img",{src:e.image||"https://via.placeholder.com/400x400?text=No+Image",alt:e.name,className:"h-full w-full object-contain transition duration-300 group-hover:scale-[1.03]",loading:"lazy"})}),t.jsxs("div",{className:"mt-4 flex flex-1 flex-col",children:[t.jsx("h3",{className:"text-sm font-medium leading-snug text-white line-clamp-2",children:e.name}),t.jsxs("div",{className:"mt-2 text-xs text-white/50",children:[t.jsx("span",{className:"font-semibold text-white/70",children:e.brand?.name})," ","•"," ",t.jsx("span",{className:"text-white/60",children:e.category?.name})]}),e.description?.trim()?t.jsxs("div",{className:"relative mt-2",children:[t.jsx("p",{className:"text-xs text-white/50 line-clamp-2",children:e.description}),t.jsx("button",{onClick:()=>A(f===e.id?null:e.id),className:"mt-1 text-xs font-semibold text-emerald-300 hover:underline",children:"View more"}),t.jsx("div",{ref:f===e.id?b:null,className:`
        absolute left-0 bottom-full z-30 mb-2 w-full
        transition-all duration-300
        ${f===e.id?"opacity-100 translate-y-0":"opacity-0 translate-y-2 pointer-events-none"}
      `,children:t.jsx("div",{className:"rounded-lg border border-white/10 bg-black/80 p-3 text-xs text-white/90 backdrop-blur-md shadow-lg",children:t.jsx("div",{className:"leading-relaxed",children:O(e.description)})})})]}):t.jsx("div",{className:"mt-2 h-[32px]"}),s!=null&&s>0&&t.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3",children:[t.jsxs("span",{className:"text-2xl font-medium tracking-tight text-white",children:["₹",R(s)]}),!!r&&r>0&&t.jsxs("span",{className:"text-sm text-white/40 line-through",children:["₹",R(r)]}),i!=null&&i>0&&t.jsxs("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-bold text-white",children:[i,"% Off"]})]}),e.min_order_quantity&&t.jsxs("span",{className:"mt-2 text-sm font-semibold text-white/80",children:["Min Order Quantity: ",e.min_order_quantity]}),t.jsx("div",{className:"mt-auto pt-5",children:t.jsx("a",{href:T(e),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-full bg-emerald-200 px-4 py-2 text-xs font-extrabold text-black transition hover:scale-[1.03] active:scale-[0.98]",children:"Order Now"})}),t.jsx("div",{className:"mt-6 h-px w-full bg-white/10"})]})]},e.id)})}),!y&&j.length===0&&t.jsxs("div",{className:"mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:[t.jsx("p",{className:"text-lg font-extrabold",children:"No products found"}),t.jsx("p",{className:"mt-2 text-sm text-white/60",children:"Try adjusting filters or clear all filters to see items."}),t.jsx("button",{onClick:P,className:"mt-5 rounded-xl bg-[#E02C2C] px-5 py-3 text-sm font-bold hover:bg-[#B91C1C] transition",children:"Clear Filters"})]})]})})};export{V as default};
