import{h as Q,a as V,r as n,j as t}from"./index-BIMCDR0N.js";import{u as Z}from"./useProducts-BQHYOwLu.js";import{u as J}from"./useBrands-DTtAH9hK.js";const I=l=>l.toLocaleString("en-IN",{maximumFractionDigits:0}),H=(l,o)=>{if(!l||!o||l<=o)return null;const g=Math.round((l-o)/l*100);return g>0?g:null},ee=()=>{const{category:l}=Q(),{data:o,isLoading:g}=Z(),{data:N,isLoading:O}=J(),{data:$}=V(),[v,P]=n.useState(null),j=n.useRef(null),y=12,[u,p]=n.useState(1),[m,A]=n.useState("All"),[x,D]=n.useState("All"),[c,S]=n.useState("All"),[d,_]=n.useState("All"),[L,F]=n.useState("All"),[a,R]=n.useState("Relevance"),b=n.useMemo(()=>Array.isArray(o)?o:[],[o]),f=$?.filter(e=>e.category_type==="LEAF"),C=n.useMemo(()=>l?b.filter(e=>e?.category?.slug===l):b,[b,l]),E=n.useMemo(()=>f?.length?[{name:"All",slug:"All"},...f.map(e=>({name:e.full_path||e.name,slug:e.slug}))]:[{name:"All",slug:"All"}],[f]),T=n.useMemo(()=>{const e=Array.isArray(N)?N.filter(r=>r.is_active):[];return e.length?["All",...e.map(r=>r.name)]:["All",...Array.from(new Set(C.map(r=>r.brand?.name).filter(Boolean)))]},[N,C]),w=n.useMemo(()=>{let e=[...b];return l&&(e=e.filter(s=>s.category?.slug===l)),m!=="All"&&(e=e.filter(s=>s.category?.slug===m)),x!=="All"&&(e=e.filter(s=>s.brand?.name===x)),c!=="All"&&(e=e.filter(s=>{const r=Number(s.price);return Number.isNaN(r)?!1:c==="Under 40k"?r<4e4:c==="40k - 70k"?r>=4e4&&r<=7e4:c==="70k+"?r>7e4:!0})),d!=="All"&&(e=e.filter(s=>{const r=Number(s.price),i=s.old_price?Number(s.old_price):0,h=H(i,r)??0;return d==="10%+"?h>=10:d==="20%+"?h>=20:!0})),e.sort((s,r)=>{const i=Number(s.price)||0,h=Number(r.price)||0;return a==="Relevance"?0:a==="Price: Low to High"?i-h:a==="Price: High to Low"?h-i:a==="Rating"?0:a==="Newest"?new Date(r.created_at).getTime()-new Date(s.created_at).getTime():0}),e},[C,m,x,L,c,d,a]),M=()=>{A("All"),D("All"),S("All"),_("All"),F("All"),R("Relevance")};n.useEffect(()=>{p(1)},[m,x,c,d,L,a,l]);const k=Math.ceil(w.length/y),U=n.useMemo(()=>{const e=(u-1)*y;return w.slice(e,e+y)},[w,u]);n.useEffect(()=>{const e=s=>{j.current&&!j.current.contains(s.target)&&P(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),n.useEffect(()=>{A("All")},[l]);const q=n.useMemo(()=>l?E.find(s=>s.slug===l)?.name||l:"Products",[l,E]),z=e=>{if(!e.includes("#"))return t.jsx("p",{children:e});const s=e.split("#").map(r=>r.trim()).filter(Boolean);return t.jsx("ul",{className:"list-disc pl-4 space-y-1",children:s.map((r,i)=>t.jsx("li",{children:r},i))})},B=g||O,W="917664939393",G=e=>{const s=`Hi, I am interested in this product:

${e.name}

Product ID: ${e.id}`;return`https://wa.me/${W}?text=${encodeURIComponent(s)}`};return t.jsx("div",{className:"min-h-screen bg-[#0B0B0D] text-white",children:t.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-6",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-white/60",children:[t.jsx("span",{className:"hover:text-white transition cursor-pointer",children:"Home"}),t.jsx("span",{className:"text-white/30",children:"›"}),t.jsx("span",{className:"hover:text-white transition cursor-pointer",children:"Categories"}),t.jsx("span",{className:"text-white/30",children:"›"}),t.jsx("span",{className:"text-white font-semibold",children:q})]}),t.jsx("div",{className:"mt-2 flex items-end justify-between gap-4",children:t.jsx("div",{})}),t.jsxs("div",{className:"mt-5 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("select",{value:m,onChange:e=>A(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:f.map(e=>t.jsxs("option",{value:e.slug,className:"bg-[#0B0B0D]",children:["Categories: ",e.name]},e.slug))}),t.jsx("select",{value:x,onChange:e=>D(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:T.map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Brand: ",e]},e))}),t.jsx("select",{value:c,onChange:e=>S(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["All","Under 40k","40k - 70k","70k+"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Price: ",e]},e))}),t.jsx("select",{value:d,onChange:e=>_(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["All","10%+","20%+"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Discount: ",e]},e))}),t.jsx("button",{onClick:M,className:"rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white hover:bg-white/10 transition",children:"Clear Filters"})]}),t.jsx("div",{className:"flex items-center justify-between gap-3 lg:justify-end",children:t.jsx("select",{value:a,onChange:e=>R(e.target.value),className:"cursor-pointer rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs font-semibold text-white outline-none hover:bg-white/10 transition",children:["Relevance","Price: Low to High","Price: High to Low","Rating","Newest"].map(e=>t.jsxs("option",{value:e,className:"bg-[#0B0B0D]",children:["Sort By ",e]},e))})})]}),B&&t.jsx("div",{className:"mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:t.jsx("p",{className:"text-sm text-white/70",children:"Loading products..."})}),!B&&t.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-4",children:U.map(e=>{const s=Number(e.price)||0,r=e.old_price?Number(e.old_price):void 0,i=H(r,s);return t.jsxs("div",{className:"group relative flex h-full flex-col rounded-xl border border-white/10 bg-white/5 p-4 transition hover:bg-white/10",children:[t.jsx("div",{className:"relative h-[240px] overflow-hidden rounded-lg bg-white p-5",children:t.jsx("img",{src:e.image||"https://via.placeholder.com/400x400?text=No+Image",alt:e.name,className:"h-full w-full object-contain transition duration-300 group-hover:scale-[1.03]",loading:"lazy"})}),t.jsxs("div",{className:"mt-4 flex flex-1 flex-col",children:[t.jsx("h3",{className:"text-sm font-medium leading-snug text-white line-clamp-2",children:e.name}),t.jsxs("div",{className:"mt-2 text-xs text-white/50",children:[t.jsx("span",{className:"font-semibold text-white/70",children:e.brand?.name})," ","•"," ",t.jsx("span",{className:"text-white/60",children:e.category?.name})]}),e.description?.trim()?t.jsxs("div",{className:"relative mt-2",children:[t.jsx("p",{className:"text-xs text-white/50 line-clamp-2",children:e.description}),t.jsx("button",{onClick:()=>P(v===e.id?null:e.id),className:"mt-1 text-xs font-semibold text-emerald-300 hover:underline",children:"View more"}),t.jsx("div",{ref:v===e.id?j:null,className:`
        absolute left-0 bottom-full z-30 mb-2 w-full
        transition-all duration-300
        ${v===e.id?"opacity-100 translate-y-0":"opacity-0 translate-y-2 pointer-events-none"}
      `,children:t.jsx("div",{className:"rounded-lg border border-white/10 bg-black/80 p-3 text-xs text-white/90 backdrop-blur-md shadow-lg",children:t.jsx("div",{className:"leading-relaxed",children:z(e.description)})})})]}):t.jsx("div",{className:"mt-2 h-[32px]"}),s!=null&&s>0&&t.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-3",children:[t.jsxs("span",{className:"text-2xl font-medium tracking-tight text-white",children:["₹ ",I(s)]}),!!r&&r>0&&t.jsxs("span",{className:"text-sm text-white/40 line-through",children:["₹ ",I(r)]}),i!=null&&i>0&&t.jsxs("span",{className:"rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-bold text-white",children:[i,"% Off"]})]}),e.min_order_quantity&&t.jsxs("span",{className:"mt-2 text-sm font-semibold text-white/80",children:["Min Order Quantity: ",e.min_order_quantity]}),t.jsx("div",{className:"mt-auto pt-5",children:t.jsx("a",{href:G(e),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-full bg-emerald-200 px-4 py-2 text-xs font-extrabold text-black transition hover:scale-[1.03] active:scale-[0.98]",children:"Order Now"})}),t.jsx("div",{className:"mt-6 h-px w-full bg-white/10"})]})]},e.id)})}),k>1&&t.jsxs("div",{className:"mt-10 flex items-center justify-center gap-2",children:[t.jsx("button",{disabled:u===1,onClick:()=>p(e=>e-1),className:"px-4 py-2 text-sm rounded-lg border border-white/10 bg-white/5 disabled:opacity-40",children:"Prev"}),Array.from({length:k},(e,s)=>s+1).map(e=>t.jsx("button",{onClick:()=>p(e),className:`px-4 py-2 text-sm rounded-lg border
          ${u===e?"bg-white text-black":"border-white/10 bg-white/5"}`,children:e},e)),t.jsx("button",{disabled:u===k,onClick:()=>p(e=>e+1),className:"px-4 py-2 text-sm rounded-lg border border-white/10 bg-white/5 disabled:opacity-40",children:"Next"})]}),!B&&w.length===0&&t.jsxs("div",{className:"mt-10 rounded-2xl border border-white/10 bg-white/5 p-8 text-center",children:[t.jsx("p",{className:"text-lg font-extrabold",children:"No products found"}),t.jsx("p",{className:"mt-2 text-sm text-white/60",children:"Try adjusting filters or clear all filters to see items."}),t.jsx("button",{onClick:M,className:"mt-5 rounded-xl bg-[#E02C2C] px-5 py-3 text-sm font-bold hover:bg-[#B91C1C] transition",children:"Clear Filters"})]})]})})};export{ee as default};
